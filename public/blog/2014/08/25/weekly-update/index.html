
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Weekly Update: AngularJS book, BirdWatch and Clojure, Web Components, Upstart and Play - Matthias Nehlsen</title>
  <meta name="author" content="Matthias Nehlsen">

  
  <meta name="description" content="In this weekly update, I will be talking about Clojure and ClojureScript, an upcoming article on AngularJS, Grunt, Karma and Protractor and how I use &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://matthiasnehlsen.com/blog/2014/08/25/weekly-update">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Matthias Nehlsen" type="application/atom+xml">
  
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Matthias Nehlsen</a></h1>
  
    <h2>Software, Data and Stuff</h2>
    
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:matthiasnehlsen.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/reviews">Reviews</a></li>
  <li><a href="/reading-lists">Reading Lists</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  <a href="https://plus.google.com/100986586701798521209" rel="publisher"></a>


  <header>
    
      <h1 class="entry-title">Weekly Update: AngularJS book, BirdWatch and Clojure, Web Components, Upstart and Play</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-25T19:06:00+02:00" pubdate data-updated="true">08/25/2014</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>In this weekly update, I will be talking about <strong>Clojure and ClojureScript</strong>, an upcoming article on <strong>AngularJS, Grunt, Karma and Protractor</strong> and how I use <strong>Upstart</strong> to run my <strong>Play</strong> applications as services on <strong>Ubuntu</strong>.</p>

<!-- more -->


<h2>AngularJS book available for pre-order on Amazon, Meetup</h2>

<p>I am very excited that the book that <strong><a href="http://amitgharat.wordpress.com">Amit Gharat</a></strong> and I wrote about <strong><a href="http://www.amazon.com/gp/product/1783288477/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1783288477&amp;linkCode=as2&amp;tag=matthiasnehls-20&amp;linkId=7WKFJKNQICCUSFES">AngularJS UI Development</a></strong> is now available for <strong><a href="http://www.amazon.com/gp/product/1783288477/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1783288477&amp;linkCode=as2&amp;tag=matthiasnehls-20&amp;linkId=7WKFJKNQICCUSFES">pre-order on Amazon</a></strong>. Interesting experience to see it being listed already while still working on the final stages.</p>

<p>We will have <strong>content</strong> available for <strong>preview</strong> soon. On my end, I will <strong>publish</strong> an article about <strong>setting up the environment for AngularJS</strong> with a <strong>build system consisting of Grunt, Bower, Karma and Protractor</strong>. Last week I also gave a talk on the subject at the <strong><a href="http://www.meetup.com/Hamburg-AngularJS-Meetup/events/196972082/">Hamburg AngularJS meetup</a></strong>. Or rather a live coding session in which we coded up an application that is being <strong>tested in Chrome, Firefox, PhantomJS and also in Mobile Safari</strong>. <strong>Android</strong> is still <strong>missing</strong> due to some difficulties but should be added soon. Two interesting questions came up during the meetup: <strong>a)</strong> How do you test swipe gestures? <strong>b)</strong> When selecting elements to click by <strong>id</strong>, will <strong><a href="https://github.com/angular/protractor">Protractor</a></strong> catch errors if an element, though visible, is covered by another element and thus cannot be clicked? Tests should also be added for cases such as these. The project the article will be based upon is already available on <strong><a href="https://github.com/matthiasn/angular-grunt-protractor-starter">GitHub</a></strong>. You may find it to be a good starting point for an <strong>AngularJS</strong> application that includes a <strong>test</strong> and <strong>build</strong> system. Besides the planned article I also want to do a <strong>screencast</strong> on the subject. Stay tuned. By the way, <strong>you</strong> could help with testing the application on Android or adding the additional test cases.</p>

<h2>Tweet stream analysis with Clojure and ClojureScript/Om</h2>

<p>I recently <strong><a href="http://matthiasnehlsen.com/blog/2014/07/24/birdwatch-cljs-om/">rewrote</a></strong> the client side of my <strong><a href="https://github.com/matthiasn/birdwatch">BirdWatch</a></strong> application using <strong><a href="https://github.com/clojure/clojurescript">ClojureScript</a></strong> and <strong><a href="https://github.com/swannodette/om">Om</a></strong>. While I enjoyed the process, I also noticed some performance issues when I tried to keep the application responsive while <strong>ingesting and transforming</strong> thousands of previous tweets as quickly as possible. While optimizations certainly could have been done on the client side alone, this was a good reminder that the information flow architecture was <strong>far from ideal</strong>. The previous version was also a bit of a <strong>Frankenstein&#8217;s patchwork</strong> of programming languages. I acknowledge that it may be a little bit of a <strong>tough sell</strong> to have to understand both <strong><a href="http://www.scala-lang.org">Scala</a></strong> and <strong><a href="http://clojure.org">Clojure</a></strong> in order to wrap your head around a single application. Totally unnecessary, too.</p>

<p>So I rewrote the server side using <strong>Clojure</strong>. That already works nicely, this time making use of <strong><a href="http://en.wikipedia.org/wiki/WebSocket">WebSockets</a></strong> instead of <strong><a href="http://en.wikipedia.org/wiki/Server-sent_events">Server-Sent Events</a></strong>. Turns out <strong>WebSockets</strong> are a nice fit conceptually for <strong><a href="http://en.wikipedia.org/wiki/Communicating_sequential_processes">CSP-style channels</a></strong>.</p>

<p>A couple of things still need to be resolved. In order to fully achieve the previous functionality, there needs to be an <strong>auto-reconnect</strong> if the connection to the <strong><a href="https://dev.twitter.com/docs/streaming-apis">Twitter Streaming API</a></strong> is lost. That should be really simple, given what is there already. Also, <strong>matching</strong> new tweets with the clients&#8217; queries using <strong>ElasticSearch</strong>&#8217;s <strong><a href="http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-percolate.html">Percolator</a></strong> and only delivering a <strong>filtered stream</strong> needs to be implemented. This is slightly more involved, but also seems totally doable.</p>

<p>Above and beyond, it seems useful to <strong>partially perform</strong> the computation (ranking by retweets, word counts) <strong>on the server</strong> in order to <strong>reduce the load</strong> on the client. With <strong>Clojure</strong> and <strong>ClojureScript</strong> being so similar, my idea is to use a part of the code base on both sides and split the computation. Then, the amount of data having to traverse the potentially slow network connection would be reduced drastically, leading to faster loading and a more <strong>mobile-friendly</strong> memory footprint of the client.</p>

<p>A new article on this application rewrite will follow soon. The work in progress code is on <strong><a href="https://github.com/matthiasn/BirdWatch/tree/2014-08-25-Clojure-Server">Github</a></strong> already, currently in a separate branch.</p>

<h2>Web Components / Polymer / X-Tag resources</h2>

<p>As already mentioned last week, I find some of the ideas behind <strong><a href="http://webcomponents.org">Web Components</a></strong> <strong>brilliant</strong>, in particular <strong>Shadow DOM</strong> and <strong>Custom Elements</strong>. Now that I am learning these concepts anyway, I thought I might as well <strong>share useful resources</strong> I come across, so I have created a <strong><a href="https://github.com/matthiasn/WebComponents-Polymer-Resources">list over on GitHub</a></strong>. Check it out and <strong>please add your links</strong> too. I expect this list to grow substantially in the next couple of weeks.</p>

<h2>Upstart scripts for Play</h2>

<p>I am running <strong>live instances</strong> of my <strong><a href="http://playframework">Play</a></strong> applications (BirdWatch, sse-chat, amzn-geo-lookup) on an <strong><a href="http://www.ubuntu.com">Ubuntu</a></strong> server. There are <strong>hardly any disruptions</strong>, something like once every few months. But whenever they occurred, I had to restart the applications <strong>manually</strong>. Not terrible when all is running smoothly, but not great either. So how could that be done better? <strong><a href="http://upstart.ubuntu.com">Upstart</a></strong> provides the answer. After some googling I found <strong><a href="http://www.agileand.me/blog/posts/play-2-2-x-upstart-init-script">this blog post</a></strong> by <strong><a href="https://twitter.com/ajevans85">Adam Evans</a></strong>. I have only slightly modified it and now, I have all of my applications running as services that I can <strong>start</strong> and <strong>stop</strong> the way one would expect, e.g.:</p>

<pre><code># status birdwatch
birdwatch start/running, process 947
# stop birdwatch
birdwatch stop/waiting
# start birdwatch
birdwatch start/running, process 30453
</code></pre>

<p>Also, the services <strong>start automatically</strong> after a system reboot.</p>

<p>So what needs to be done? First of all, we need a standalone instance of the applications using the <strong><a href="https://www.playframework.com/documentation/2.2.x/ProductionDist">dist</a></strong> command, e.g.;</p>

<pre><code># play dist
[info] Loading project definition from /home/bw/BirdWatch/project
[info] Set current project to BirdWatch (in build file:/home/bw/BirdWatch/)
[info] Wrote /home/bw/BirdWatch/target/scala-2.10/birdwatch_2.10-0.3.0.pom
[info] 
[info] Your package is ready in /home/bw/BirdWatch/target/universal/birdwatch-0.3.0.zip
</code></pre>

<p>We can unpack the zip file where we choose and then simply adapt the script from the blog post mentioned above, in this case:</p>

<pre><code>description "Upstart script for https://github.com/matthiasn/Birdwatch, modified from http://www.agileand.me/blog/posts/play-2-2-x-upstart-init-script"

env USER=bw
env GROUP=www
env APP_HOME=/home/bw/apps/birdwatch-0.3.0
env APP_NAME=birdwatch
env PORT=9000
env BIND_ADDRESS=0.0.0.0
env EXTRA=""

start on (filesystem and net-device-up IFACE=lo)
stop on runlevel [!2345]

respawn
respawn limit 30 10
umask 022
expect daemon

pre-start script
    #If improper shutdown and the PID file is left on disk delete it so we can start again

    if [ -f $APP_HOME/RUNNING_PID ] &amp;&amp; ! ps -p `cat $APP_HOME/RUNNING_PID` &gt; /dev/null ; then
        rm $HOME/RUNNING_PID ;
    fi
end script

exec start-stop-daemon --pidfile ${APP_HOME}/RUNNING_PID --chdir ${APP_HOME} --chuid $USER:$GROUP --exec ${APP_HOME}/bin/$APP_NAME --background --start -- -Dhttp.port=$PORT -Dhttp.address=$BIND_ADDRESS $EXTRA
</code></pre>

<p>Et voilà - after a restart of the server, all services come up as expected. Much nicer. The script is also on <strong><a href="https://github.com/matthiasn/BirdWatch/blob/797c9b27eeb018138e90f95ad3df8774b4fbd6e5/conf/upstart/birdwatch.conf">GitHub</a></strong>. For more information, check out the <strong><a href="http://upstart.ubuntu.com/cookbook/">upstart cookbok</a></strong> and the <strong><a href="http://upstart.ubuntu.com/getting-started.html">getting started guide</a></strong>.</p>

<h2>Conclusion</h2>

<p>Last week was fairly <strong>productive</strong>, I got some really cool stuff done that had been on my mind for a while. I hope to continue this flow in the week that has just started. I&#8217;ll let you know next week. <strong><a href="http://en.wikipedia.org/wiki/Cliffhanger">Cliffhanger</a></strong>: I recently increased the <strong><a href="https://developers.google.com/speed/pagespeed/insights/?url=http%3A%2F%2Fmatthiasnehlsen.com&amp;tab=desktop">Google PageSpeed Insights</a></strong> score of this blog by a lot, from <strong>58/100 to 83/100 for mobile</strong> and from <strong>77/100 to 90/100 for desktop</strong>.</p>

<p><img class="left" src="/images/pagespeed.png" title="'pagespeed results'" ></p>

<p>It also feels like the pages are loading a lot faster. <strong>Next week</strong> I&#8217;ll let you know what I did. Would you like to get notified when the next article is out? Just <strong>sign up</strong> for the <a href="http://eepurl.com/y0HWv" target="_blank"><strong>mailing list</strong></a>.</p>

<p>Have a great week,
Matthias</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Matthias Nehlsen</span></span>

      








  


<time datetime="2014-08-25T19:06:00+02:00" pubdate data-updated="true">08/25/2014</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://matthiasnehlsen.com/blog/2014/08/25/weekly-update/" data-via="matthiasnehlsen" data-counturl="http://matthiasnehlsen.com/blog/2014/08/25/weekly-update/" >Tweet</a>
  

  
  <div class="g-plusone" data-size="medium"></div>
  

  
  
  
  
  <br />
  
  
    <div class="fb-like" data-send="true" data-width="600" data-show-faces="false"></div>
  
  
  <br />
  <br />
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/08/17/weekly-update/" title="Previous Post: Weekly Update: git vs brain fart, Octopress, Sony A7, my audio setup">&laquo; Weekly Update: git vs brain fart, Octopress, Sony A7, my audio setup</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section>
	<span>
		<img src="http://www.gravatar.com/avatar/3f6cb2a9b1057c35f284174063835d41?s=250" alt="Gravatar of Matthias Nehlsen " title="Gravatar of Matthias Nehlsen" />
	</span>
</section>
<section>
  <h1>About Me</h1>
  <p>Hello everyone. My name is Matthias Nehlsen and I am exploring functional programming, data visualization and real-time information processing.</p>
</section>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/08/25/weekly-update/">Weekly Update: AngularJS book, BirdWatch and Clojure, Web Components, Upstart and Play</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/17/weekly-update/">Weekly Update: git vs brain fart, Octopress, Sony A7, my audio setup</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/10/weekly-update/">Weekly Update: AngularJS book, Geo-Lookup, Reading</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/04/building-a-geo-aware-link-shortener-with-play-framework/">Building a geo-aware link shortener with Play Framework</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/01/weekly-update/">Weekly Update: Buying time, AngularJS Meetup, Mountains</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li><a href="https://github.com/matthiasn/birdwatch">BirdWatch</a>
      <p>Reactive web application using Play Framework 2.2 for consuming and visualizing live Tweets from the Twitter Streaming API.</p>
        <iframe src="http://ghbtns.com/github-btn.html?user=matthiasn&repo=birdwatch&type=watch&count=true"
          allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
    </li>
    <li><a href="https://github.com/matthiasn/sse-chat">sse-chat</a>
      <p>Chat example app using Server Sent Events plus REST calls. Client side implementations both in AngularJS and in React.</p>
      <iframe src="http://ghbtns.com/github-btn.html?user=matthiasn&repo=sse-chat&type=watch&count=true"
        allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
    </li>
    <li><a href="https://github.com/matthiasn/sse-perf">sse-perf</a>
      <p>Reactive web application using Play Framework 2.1 for load testing Server Sent Event streams (or other HTTP connections that deliver information in chunks).</p>
      <iframe src="http://ghbtns.com/github-btn.html?user=matthiasn&repo=sse-perf&type=watch&count=true"
        allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
    </li>
    <li><a href="https://github.com/matthiasn/Clojure-Resources">Clojure-Resources</a>&nbsp;
        <p>Compilation of useful links and resources for learning Clojure and ClojureScript </p>
        <iframe src="http://ghbtns.com/github-btn.html?user=matthiasn&repo=Clojure-Resources&type=watch&count=true"
        allowtransparency="true" frameborder="0" scrolling="0" width="110" height="20"></iframe>
      </li>
  </ul>
</section>
<section>
    <a name="signup"><h1>Subscribe</h1></a>
    <div id="mc_embed_signup">
      <form action="http://matthiasnehlsen.us7.list-manage1.com/subscribe/post?u=798fd7b50a1d9cc58be41c2af&amp;id=eb7a7193c5" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
        <div class="mc-field-group">
          <label for="mce-EMAIL">Enter your email to receive updates</label>
          <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="you@email.com" />
        </div>
        <div id="mce-responses" class="clear">
          <div class="response" id="mce-error-response" style="display:none"></div>
          <div class="response" id="mce-success-response" style="display:none"></div>
        </div>
      <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </form>
    
    <br />
  </div>
</section>
<SCRIPT charset="utf-8" type="text/javascript" src="http://r.matthiasnehlsen.com/slideshow1/narrow"> </SCRIPT>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Matthias Nehlsen -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'matthiasnehlsen';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://matthiasnehlsen.com/blog/2014/08/25/weekly-update/';
        var disqus_url = 'http://matthiasnehlsen.com/blog/2014/08/25/weekly-update/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



  
  <script src="//use.typekit.net/rco1jij.js"></script>
  <script>try{Typekit.load();} catch (e){}</script>

  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-40261983-1', 'auto');
  ga('send', 'pageview');
</script>


  

</body>
</html>
